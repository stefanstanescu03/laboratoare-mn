function [H] = QR(A, tol)
    [n, ~] = size(A);
    [ Q, H ] = HQ(A)
    iter = 0;
    m = n;
    while m > 1
        u = H(m, m);
        for i = 1:m
            H(i, i) = H(i, i) - u;
        end
        [Q, R] = qr(H(1 : m, 1 : m));
        H(1:m, 1:m) = R * Q;
        for i = 1:m
            H(i, i) = H(i, i) + u;
        end
        if m < n
            H(1 : m, m + 1 : n) = Q' * H(1 : m, m + 1 : n)
        end
        Q(:, 1 : m) = Q(:, 1 : m) * Q 
    end
end

